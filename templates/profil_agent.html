{% extends "base.html" %}
{% block header_title %}Mon Profil{% endblock %}
{% block content %}

<div class="max-w-4xl mx-auto px-4 py-8">
  <!-- Carte principale -->
  <div class="bg-white dark:bg-dark-800 rounded-2xl shadow-xl overflow-hidden transition-all duration-300 hover:shadow-2xl">
    <!-- En-tête avec dégradé -->
    <div class="bg-gradient-to-r from-primary to-secondary p-6">
      <h1 class="text-2xl font-bold text-white flex items-center justify-center">
        <i class="fas fa-user-circle mr-3"></i>
        Mon Profil
      </h1>
    </div>
    
    <div class="p-6">
      <!-- Section profil -->
      <div class="flex flex-col md:flex-row items-center md:items-start gap-8 mb-8">
        <!-- Photo de profil -->
        <div class="relative">
          <img src="{{ photo_url }}" alt="Photo de profil" 
               class="w-40 h-40 rounded-full border-4 border-white dark:border-dark-800 shadow-xl object-cover">
          
          <div class="absolute -bottom-2 -right-2 bg-white dark:bg-dark-700 rounded-full p-2 shadow-lg">
            <i class="fas fa-user text-primary text-xl"></i>
          </div>
        </div>
        
        <!-- Informations -->
        <div class="text-center md:text-left flex-1">
          <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-200 mb-2">{{ agent_nom }}</h2>
          
          <div class="flex flex-wrap gap-4 justify-center md:justify-start mb-6">
            <div class="bg-gray-100 dark:bg-gray-700/50 px-4 py-2 rounded-lg">
              <p class="text-sm text-gray-500 dark:text-gray-400">Rôle</p>
              <p class="font-medium">{{ session.agent_role }}</p>
            </div>
            
            <div class="bg-gray-100 dark:bg-gray-700/50 px-4 py-2 rounded-lg">
              <p class="text-sm text-gray-500 dark:text-gray-400">Connecté depuis</p>
              <p class="font-medium">{{ session.get('login_time', 'Aujourd\'hui') }}</p>
            </div>
          </div>
          
          <div class="max-w-md mx-auto md:mx-0">
            <div class="flex items-center justify-center md:justify-start text-gray-600 dark:text-gray-400 mb-1">
              <i class="fas fa-info-circle mr-2"></i>
              <p>Pour modifier votre photo de profil, utilisez le formulaire ci-dessous</p>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Séparateur -->
      <div class="flex items-center mb-8">
        <div class="h-px flex-1 bg-gray-200 dark:bg-gray-700"></div>
        <div class="px-4 text-gray-500 dark:text-gray-400 flex items-center">
          <i class="fas fa-camera mr-2"></i>
          Mettre à jour ma photo
        </div>
        <div class="h-px flex-1 bg-gray-200 dark:bg-gray-700"></div>
      </div>
      
      <!-- Formulaire de changement de photo -->
      <form method="post" enctype="multipart/form-data" class="max-w-lg mx-auto">
        <div class="mb-6">
          <label class="block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300">
            Sélectionner une nouvelle image
          </label>
          <div class="flex items-center">
            <input type="file" name="photo" accept="image/*" required
                   class="flex-1 block w-full text-sm text-gray-500 dark:text-gray-400
                          file:mr-4 file:py-2 file:px-4
                          file:rounded-lg file:border-0
                          file:text-sm file:font-medium
                          file:bg-gray-100 dark:file:bg-gray-700 file:text-gray-700 dark:file:text-gray-300
                          hover:file:bg-gray-200 dark:hover:file:bg-gray-600
                          transition-colors">
          </div>
          <p class="mt-2 text-xs text-gray-500 dark:text-gray-400">
            Formats acceptés: JPG, PNG, JPEG (max 5MB)
          </p>
        </div>
        
        <div class="flex justify-center gap-4">
          <button type="submit"
                  class="px-8 py-3 bg-gradient-to-r from-primary to-secondary hover:from-primary/90 hover:to-secondary/90 text-white font-semibold rounded-xl shadow-md transition-all duration-300 transform hover:-translate-y-0.5 flex items-center">
            <i class="fas fa-upload mr-2"></i>
            Mettre à jour ma photo
          </button>
          
          <a href="{{ url_for('dashboard') }}"
             class="px-8 py-3 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 font-semibold rounded-xl shadow-md transition-colors duration-300 flex items-center">
            <i class="fas fa-home mr-2"></i>
            Retour au tableau de bord
          </a>
        </div>
      </form>
    </div>
  </div>
  
  <div class="mt-8 grid grid-cols-1 md:grid-cols-3 gap-6">
    <!-- Clients validés -->
    <div class="bg-gradient-to-r from-green-500/10 to-emerald-500/10 dark:from-green-900/30 dark:to-emerald-900/30 rounded-2xl p-6 shadow-md">
      <div class="flex items-center">
        <div class="w-12 h-12 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center mr-4">
          <i class="fas fa-check-circle text-green-600 dark:text-green-400 text-xl"></i>
        </div>
        <div>
          <p class="text-sm text-gray-500 dark:text-gray-400">Clients validés</p>
          <p class="text-2xl font-bold text-green-600 dark:text-green-400">{{ clients_valides }}</p>
        </div>
      </div>
    </div>
    
    <!-- Total clients -->
    <div class="bg-gradient-to-r from-blue-500/10 to-indigo-500/10 dark:from-blue-900/30 dark:to-indigo-900/30 rounded-2xl p-6 shadow-md">
      <div class="flex items-center">
        <div class="w-12 h-12 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center mr-4">
          <i class="fas fa-users text-blue-600 dark:text-blue-400 text-xl"></i>
        </div>
        <div>
          <p class="text-sm text-gray-500 dark:text-gray-400">Total clients</p>
          <p class="text-2xl font-bold text-blue-600 dark:text-blue-400">{{ total_clients }}</p>
        </div>
      </div>
    </div>
    
    <!-- Position classement -->
    <div class="bg-gradient-to-r from-amber-500/10 to-orange-500/10 dark:from-amber-900/30 dark:to-orange-900/30 rounded-2xl p-6 shadow-md">
      <div class="flex items-center">
        <div class="w-12 h-12 rounded-full bg-amber-100 dark:bg-amber-900/30 flex items-center justify-center mr-4">
          <i class="fas fa-trophy text-amber-600 dark:text-amber-400 text-xl"></i>
        </div>
        <div>
          <p class="text-sm text-gray-500 dark:text-gray-400">Position classement</p>
          <p class="text-2xl font-bold text-amber-600 dark:text-amber-400">
            {% if position != '-' %}#{{ position }}{% else %}-{% endif %}
          </p>
        </div>
      </div>
    </div>
  </div>  
    
    
    </div>
  </div>
</div>

{% endblock %}