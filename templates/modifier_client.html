{% extends "base.html" %}
{% block content %}

<div class="max-w-2xl mx-auto px-4 py-8">
    <!-- Alerte doublon -->
    {% if doublon %}
    <div class="mb-6 bg-red-100 dark:bg-red-900/30 border-l-4 border-red-500 text-red-700 dark:text-red-200 p-4 rounded-lg shadow-md">
        <div class="flex items-start">
            <div class="flex-shrink-0">
                <i class="fas fa-exclamation-triangle text-xl"></i>
            </div>
            <div class="ml-3">
                <p class="font-medium">Client déjà existant</p>
                <p class="mt-1">Ce client a déjà été saisi par <strong class="font-bold">{{ ancien_agent }}</strong>.</p>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Carte principale -->
    <div class="bg-white dark:bg-dark-800 rounded-2xl shadow-xl overflow-hidden transition-all duration-300 hover:shadow-2xl">
        <!-- En-tête avec dégradé -->
        <div class="bg-gradient-to-r from-primary to-secondary p-6">
            <h1 class="text-2xl font-bold text-white flex items-center justify-center">
                <i class="fas fa-user-edit mr-3"></i>
                Modifier un client SFR
            </h1>
        </div>
        
        <!-- Formulaire -->
        <form method="post" autocomplete="off" class="p-6">
            <!-- Grille de champs -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <!-- Date de signature -->
                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300">
                        <i class="fas fa-calendar-alt mr-2"></i>Date de signature
                    </label>
                    <input name="DATE_SIGNATURE" type="date" value="{{ client[1] }}" required
                        class="w-full px-4 py-3 rounded-lg border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700 focus:ring-2 focus:ring-primary/50 focus:border-transparent text-gray-900 dark:text-white">
                </div>
                
                <!-- Civilité -->
                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300">
                        <i class="fas fa-user-tag mr-2"></i>Civilité
                    </label>
                    <select name="CIVILITE_CLIENT" required
                        class="w-full px-4 py-3 rounded-lg border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700 focus:ring-2 focus:ring-primary/50 focus:border-transparent text-gray-900 dark:text-white">
                        <option value="MONSIEUR" {% if client[2] == 'MONSIEUR' %}selected{% endif %}>Monsieur</option>
                        <option value="MADAME" {% if client[2] == 'MADAME' %}selected{% endif %}>Madame</option>
                        <option value="Autre" {% if client[2] == 'Autre' %}selected{% endif %}>Autre</option>
                    </select>
                </div>
                
                <!-- Nom -->
                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300">
                        <i class="fas fa-user mr-2"></i>Nom
                    </label>
                    <input name="NOM_CLIENT" value="{{ client[3] }}" required
                        class="w-full px-4 py-3 rounded-lg border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700 focus:ring-2 focus:ring-primary/50 focus:border-transparent text-gray-900 dark:text-white">
                </div>
                
                <!-- Prénom -->
                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300">
                        <i class="fas fa-user mr-2"></i>Prénom
                    </label>
                    <input name="PRENOM_CLIENT" value="{{ client[4] }}" required
                        class="w-full px-4 py-3 rounded-lg border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700 focus:ring-2 focus:ring-primary/50 focus:border-transparent text-gray-900 dark:text-white">
                </div>
                
                <!-- Téléphone -->
                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300">
                        <i class="fas fa-phone-alt mr-2"></i>Téléphone
                    </label>
                    <input name="TELEPHONE" value="{{ client[5] }}" required
                        class="w-full px-4 py-3 rounded-lg border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700 focus:ring-2 focus:ring-primary/50 focus:border-transparent text-gray-900 dark:text-white">
                </div>
                
                <!-- Statut -->
                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300">
                        <i class="fas fa-chart-line mr-2"></i>Statut
                    </label>
                    <select name="STATUT" required
                        class="w-full px-4 py-3 rounded-lg border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700 focus:ring-2 focus:ring-primary/50 focus:border-transparent text-gray-900 dark:text-white">
                        <option value="Nouveau" {% if client[6] == 'Nouveau' %}selected{% endif %}>Nouveau</option>
                        <option value="En cours" {% if client[6] == 'En cours' %}selected{% endif %}>En cours</option>
                        <option value="valide" {% if client[6] == 'valide' %}selected{% endif %}>Validé</option>
                        <option value="non valide" {% if client[6] == 'non valide' %}selected{% endif %}>Non validé</option>
                    </select>
                </div>
                
                <!-- Agent -->
                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300">
                        <i class="fas fa-user-tie mr-2"></i>Agent
                    </label>
                    <select name="AGENT" required
                        class="w-full px-4 py-3 rounded-lg border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700 focus:ring-2 focus:ring-primary/50 focus:border-transparent text-gray-900 dark:text-white">
                        {% for agent in agents %}
                            <option value="{{ agent }}" {% if client[7] == agent %}selected{% endif %}>{{ agent }}</option>
                        {% endfor %}
                    </select>
                </div>
                
                <!-- Deuxième adresse -->
                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300">
                        <i class="fas fa-map-marker-alt mr-2"></i>Deuxième adresse
                    </label>
                    <select name="DEUXIEME_ADRESSE"
                        class="w-full px-4 py-3 rounded-lg border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700 focus:ring-2 focus:ring-primary/50 focus:border-transparent text-gray-900 dark:text-white">
                        <option value="" {% if client[8] == '' %}selected{% endif %}>(Aucune)</option>
                        <option value="adr 2" {% if client[8] == 'adr 2' %}selected{% endif %}>adr 2</option>
                        <option value="adr 3" {% if client[8] == 'adr 3' %}selected{% endif %}>adr 3</option>
                    </select>
                </div>
                
                <!-- Troisième adresse -->
                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300">
                        <i class="fas fa-map-marker-alt mr-2"></i>Troisième adresse
                    </label>
                    <select name="TROISIEME_ADRESSE"
                        class="w-full px-4 py-3 rounded-lg border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700 focus:ring-2 focus:ring-primary/50 focus:border-transparent text-gray-900 dark:text-white">
                        <option value="" {% if client[9] == '' %}selected{% endif %}>(Aucune)</option>
                        <option value="adr 3" {% if client[9] == 'adr 3' %}selected{% endif %}>adr 3</option>
                        <option value="adr 4" {% if client[9] == 'adr 4' %}selected{% endif %}>adr 4</option>
                    </select>
                </div>
            </div>
            
            <!-- Boutons d'action -->
            <div class="flex flex-col sm:flex-row justify-center gap-6 mt-8">
                <button type="submit"
                    class="px-8 py-3 bg-gradient-to-r from-primary to-secondary hover:from-primary/90 hover:to-secondary/90 text-white font-semibold rounded-xl shadow-md transition-all duration-300 transform hover:-translate-y-0.5 flex items-center justify-center">
                    <i class="fas fa-save mr-2"></i>
                    Enregistrer les modifications
                </button>
                
                <a href="{{ url_for('dashboard') }}"
                    class="px-8 py-3 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 font-semibold rounded-xl shadow-md transition-colors duration-300 flex items-center justify-center">
                    <i class="fas fa-times mr-2"></i>
                    Annuler
                </a>
            </div>
        </form>
    </div>
</div>

{% endblock %}